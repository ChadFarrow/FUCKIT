(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1014],{1:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>i});var s=a(5155),r=a(2115);let l=e=>{try{let t=new DOMParser().parseFromString(e,"text/xml");if(t.getElementsByTagName("parsererror")[0])throw Error("Invalid XML format");let a=[];return Array.from(t.getElementsByTagName("podcast:valueTimeSplit")).forEach(e=>{let t=e.getAttribute("startTime")||"",s=e.getAttribute("duration")||"",r=parseInt(e.getAttribute("remotePercentage")||"0"),l=e.getAttribute("remoteValue")||"",n=e.getAttribute("type")||"",i=e.getAttribute("method")||"",c=e.getAttribute("suggested")||void 0,o=e.getAttribute("name")||void 0,d=e.getAttribute("image")||void 0,m=e.getAttribute("customKey")||void 0,x=e.getAttribute("customValue")||void 0;a.push({startTime:t,duration:s,remotePercentage:r,remoteValue:l,type:n,method:i,suggested:c,name:o,image:d,customKey:m,customValue:x})}),console.log("\uD83D\uDCB0 Found ".concat(a.length," value-time-splits in XML")),a}catch(e){throw console.error("❌ Error parsing value-time-splits from XML:",e),e}},n=e=>{try{var t,a,s;let r=new DOMParser().parseFromString(e,"text/xml");if(r.getElementsByTagName("parsererror")[0])return;let l=r.getElementsByTagName("channel");if(!l||0===l.length)return;let n=l[0],i=n.getElementsByTagName("title")[0],c=(null==i||null==(t=i.textContent)?void 0:t.trim())||"",o=n.getElementsByTagName("description")[0],d=(null==o||null==(a=o.textContent)?void 0:a.trim())||"",m=c,x=n.getElementsByTagName("itunes:author"),u=x.length>0?x[0]:n.getElementsByTagName("author")[0];return u&&(m=(null==(s=u.textContent)?void 0:s.trim())||m),{title:c,description:d,artist:m}}catch(e){console.error("❌ Error extracting metadata from XML:",e);return}};function i(){let[e,t]=(0,r.useState)("url"),[a,i]=(0,r.useState)(""),[c,o]=(0,r.useState)(""),[d,m]=(0,r.useState)(!1),[x,u]=(0,r.useState)(null),g=async()=>{m(!0);let t=Date.now();try{let s,r=[];if("url"===e){if(!a.trim())throw Error("Please enter a feed URL");console.log("\uD83D\uDD0D Fetching value-time-splits from: ".concat(a));let e=await fetch("/api/fetch-rss?url=".concat(encodeURIComponent(a)));if(!e.ok)throw Error("Failed to fetch feed: ".concat(e.status," ").concat(e.statusText));let t=await e.text();r=l(t),s=n(t)}else{if(!c.trim())throw Error("Please enter XML content");console.log("\uD83D\uDD0D Parsing value-time-splits from XML content"),r=l(c),s=n(c)}let i=(e=>{let t=[],a=[],s=0,r=0;if(0===e.length)return t.push("No value-time-splits found in the feed"),{errors:t,warnings:a,totalPercentage:s,totalDuration:"PT0S"};e.forEach((l,n)=>{var i,c,o;if(l.startTime?(e=>{let t=e.match(/^(\d{1,2}):(\d{2}):(\d{2})$/);if(!t)return!1;let a=parseInt(t[1]),s=parseInt(t[2]),r=parseInt(t[3]);return a>=0&&a<=23&&s>=0&&s<=59&&r>=0&&r<=59})(l.startTime)||t.push("Split ".concat(n+1,": Invalid startTime format (expected HH:MM:SS): ").concat(l.startTime)):t.push("Split ".concat(n+1,": Missing startTime")),l.duration)if(i=l.duration,/^PT(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)S)?$/.test(i)){let e=l.duration.match(/^PT(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)S)?$/);if(e){let t=parseInt(e[1]||"0"),a=parseInt(e[2]||"0"),s=parseInt(e[3]||"0");r+=3600*t+60*a+s}}else t.push("Split ".concat(n+1,": Invalid duration format (expected PT1H30M15S): ").concat(l.duration));else t.push("Split ".concat(n+1,": Missing duration"));if(((l.remotePercentage<0||l.remotePercentage>100)&&t.push("Split ".concat(n+1,": remotePercentage must be between 0 and 100: ").concat(l.remotePercentage)),s+=l.remotePercentage,l.remoteValue)?l.remoteValue.includes("@")?(c=l.remoteValue,/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(c)||a.push("Split ".concat(n+1,": remoteValue may not be a valid Lightning address: ").concat(l.remoteValue))):l.remoteValue.startsWith("bc1")||l.remoteValue.startsWith("1")||l.remoteValue.startsWith("3")?(o=l.remoteValue,/^(bc1|[13])[a-km-zA-HJ-NP-Z1-9]{25,62}$/.test(o)||a.push("Split ".concat(n+1,": remoteValue may not be a valid Bitcoin address: ").concat(l.remoteValue))):a.push("Split ".concat(n+1,": remoteValue format not recognized: ").concat(l.remoteValue)):t.push("Split ".concat(n+1,": Missing remoteValue")),l.type?["lightning","hive","webmonetization"].includes(l.type)||a.push("Split ".concat(n+1,": Unknown type: ").concat(l.type)):t.push("Split ".concat(n+1,": Missing type")),l.method?["keysend","lnurl-pay","lightning","hive","webmonetization"].includes(l.method)||a.push("Split ".concat(n+1,": Unknown method: ").concat(l.method)):t.push("Split ".concat(n+1,": Missing method")),n>0){let t=e[n-1],s=t.startTime;t.duration,s===l.startTime&&a.push("Split ".concat(n+1,": May overlap with previous split at time ").concat(l.startTime))}}),Math.abs(s-100)>.01&&a.push("Total remotePercentage is ".concat(s.toFixed(2),"%, should be 100%"));let l=Math.floor(r/3600),n=Math.floor(r%3600/60),i=r%60,c="PT";return l>0&&(c+="".concat(l,"H")),n>0&&(c+="".concat(n,"M")),i>0&&(c+="".concat(i,"S")),"PT"===c&&(c="PT0S"),{errors:t,warnings:a,totalPercentage:s,totalDuration:c}})(r),o=Date.now()-t;u({success:0===i.errors.length,splits:r,errors:i.errors,warnings:i.warnings,totalPercentage:i.totalPercentage,totalDuration:i.totalDuration,metadata:s,processingTime:o})}catch(e){console.error("❌ Error testing value-time-splits:",e),u({success:!1,splits:[],errors:[e instanceof Error?e.message:"Unknown error occurred"],warnings:[],totalPercentage:0,totalDuration:"PT0S"})}finally{m(!1)}},p=e=>{let t=e.match(/^PT(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)S)?$/);if(!t)return e;let a=parseInt(t[1]||"0"),s=parseInt(t[2]||"0"),r=parseInt(t[3]||"0"),l=[];return a>0&&l.push("".concat(a,"h")),s>0&&l.push("".concat(s,"m")),r>0&&l.push("".concat(r,"s")),l.join(" ")||"0s"};return(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,s.jsxs)("div",{className:"max-w-6xl mx-auto px-4",children:[(0,s.jsxs)("div",{className:"text-center mb-8",children:[(0,s.jsx)("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:"\uD83D\uDCB0 Value-Time-Split Validator"}),(0,s.jsx)("p",{className:"text-lg text-gray-600",children:"Validate podcast:valueTimeSplit elements in RSS feeds"})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-8",children:[(0,s.jsxs)("div",{className:"flex space-x-4 mb-4",children:[(0,s.jsx)("button",{onClick:()=>t("url"),className:"px-4 py-2 rounded-md font-medium ".concat("url"===e?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:"Feed URL"}),(0,s.jsx)("button",{onClick:()=>t("xml"),className:"px-4 py-2 rounded-md font-medium ".concat("xml"===e?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:"Paste XML"})]}),"url"===e?(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"RSS Feed URL"}),(0,s.jsx)("input",{type:"url",value:a,onChange:e=>i(e.target.value),placeholder:"https://example.com/feed.xml",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}):(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"XML Content"}),(0,s.jsx)("textarea",{value:c,onChange:e=>o(e.target.value),placeholder:"Paste your RSS feed XML here...",rows:10,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 font-mono text-sm"})]}),(0,s.jsxs)("div",{className:"flex space-x-4 mt-4",children:[(0,s.jsx)("button",{onClick:g,disabled:d,className:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:d?"Validating...":"Validate Value-Time-Splits"}),(0,s.jsx)("button",{onClick:()=>{u(null),i(""),o("")},className:"px-6 py-2 bg-gray-500 text-white rounded-md hover:bg-gray-600",children:"Clear"})]})]}),x&&(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Validation Results"}),(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)("span",{className:"px-3 py-1 rounded-full text-sm font-medium ".concat(x.success?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:x.success?"✅ Valid":"❌ Invalid"}),x.processingTime&&(0,s.jsxs)("span",{className:"text-sm text-gray-500",children:["Processed in ",x.processingTime,"ms"]})]})]}),x.metadata&&(0,s.jsxs)("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[(0,s.jsx)("h3",{className:"font-semibold text-gray-900 mb-2",children:"Feed Information"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-medium text-gray-600",children:"Title:"}),(0,s.jsx)("p",{className:"text-gray-900",children:x.metadata.title||"N/A"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-medium text-gray-600",children:"Artist:"}),(0,s.jsx)("p",{className:"text-gray-900",children:x.metadata.artist||"N/A"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-medium text-gray-600",children:"Description:"}),(0,s.jsx)("p",{className:"text-gray-900 truncate",children:x.metadata.description||"N/A"})]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[(0,s.jsxs)("div",{className:"p-4 bg-blue-50 rounded-lg text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:x.splits.length}),(0,s.jsx)("div",{className:"text-sm text-blue-800",children:"Value-Time-Splits"})]}),(0,s.jsxs)("div",{className:"p-4 bg-green-50 rounded-lg text-center",children:[(0,s.jsxs)("div",{className:"text-2xl font-bold text-green-600",children:[x.totalPercentage.toFixed(1),"%"]}),(0,s.jsx)("div",{className:"text-sm text-green-800",children:"Total Percentage"})]}),(0,s.jsxs)("div",{className:"p-4 bg-purple-50 rounded-lg text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-purple-600",children:p(x.totalDuration)}),(0,s.jsx)("div",{className:"text-sm text-purple-800",children:"Total Duration"})]}),(0,s.jsxs)("div",{className:"p-4 bg-orange-50 rounded-lg text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-orange-600",children:x.errors.length}),(0,s.jsx)("div",{className:"text-sm text-orange-800",children:"Errors"})]})]}),x.errors.length>0&&(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-red-800 mb-3",children:"❌ Errors"}),(0,s.jsx)("div",{className:"space-y-2",children:x.errors.map((e,t)=>(0,s.jsx)("div",{className:"p-3 bg-red-50 border border-red-200 rounded-md",children:(0,s.jsx)("p",{className:"text-red-800 text-sm",children:e})},t))})]}),x.warnings.length>0&&(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-yellow-800 mb-3",children:"⚠️ Warnings"}),(0,s.jsx)("div",{className:"space-y-2",children:x.warnings.map((e,t)=>(0,s.jsx)("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded-md",children:(0,s.jsx)("p",{className:"text-yellow-800 text-sm",children:e})},t))})]}),x.splits.length>0&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"\uD83D\uDCB0 Value-Time-Splits"}),(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,s.jsx)("thead",{className:"bg-gray-50",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"#"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Start Time"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Duration"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Percentage"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Method"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Recipient"})]})}),(0,s.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:x.splits.map((e,t)=>(0,s.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:t+1}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.startTime}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:p(e.duration)}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(0,s.jsxs)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(100===e.remotePercentage?"bg-green-100 text-green-800":e.remotePercentage>50?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"),children:[e.remotePercentage,"%"]})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(0,s.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat("lightning"===e.type?"bg-yellow-100 text-yellow-800":"hive"===e.type?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"),children:e.type})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.method}),(0,s.jsxs)("td",{className:"px-6 py-4 text-sm text-gray-900",children:[(0,s.jsx)("div",{className:"max-w-xs truncate",title:e.remoteValue,children:e.remoteValue}),e.name&&(0,s.jsx)("div",{className:"text-xs text-gray-500 truncate",title:e.name,children:e.name})]})]},t))})]})})]})]})]})})}},4788:(e,t,a)=>{Promise.resolve().then(a.bind(a,1))}},e=>{e.O(0,[8441,5964,7358],()=>e(e.s=4788)),_N_E=e.O()}]);