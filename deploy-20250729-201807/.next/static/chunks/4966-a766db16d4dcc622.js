"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4966],{1404:(e,t,r)=>{r.d(t,{uV:()=>o,tG:()=>l,vf:()=>c,u1:()=>s,bD:()=>u});class n{setContext(e){this.context={...this.context,...e}}formatMessage(e,t,r){let n=new Date().toISOString(),a={...this.context,...r},l=Object.keys(a).length>0?" [".concat(Object.entries(a).map(e=>{let[t,r]=e;return"".concat(t,"=").concat(r)}).join(", "),"]"):"";return"[".concat(n,"] [").concat(e,"]").concat(l," ").concat(t)}debug(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];this.level<=0&&console.log(this.formatMessage("DEBUG",e),...r)}info(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];this.level<=1&&console.log(this.formatMessage("INFO",e),...r)}warn(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];this.level<=2&&console.warn(this.formatMessage("WARN",e),...r)}error(e,t,r){if(this.level<=3){let n=t instanceof Error?{name:t.name,message:t.message,stack:t.stack}:t;console.error(this.formatMessage("ERROR",e,r),n)}}time(e){this.level<=0&&console.time("[PERF] ".concat(e))}timeEnd(e){this.level<=0&&console.timeEnd("[PERF] ".concat(e))}component(e){var t=this;return{debug:function(r){for(var n=arguments.length,a=Array(n>1?n-1:0),l=1;l<n;l++)a[l-1]=arguments[l];return t.debug(r,...a,{component:e})},info:function(r){for(var n=arguments.length,a=Array(n>1?n-1:0),l=1;l<n;l++)a[l-1]=arguments[l];return t.info(r,...a,{component:e})},warn:function(r){for(var n=arguments.length,a=Array(n>1?n-1:0),l=1;l<n;l++)a[l-1]=arguments[l];return t.warn(r,...a,{component:e})},error:(t,r)=>this.error(t,r,{component:e})}}function(e){var t=this;return{debug:function(r){for(var n=arguments.length,a=Array(n>1?n-1:0),l=1;l<n;l++)a[l-1]=arguments[l];return t.debug(r,...a,{function:e})},info:function(r){for(var n=arguments.length,a=Array(n>1?n-1:0),l=1;l<n;l++)a[l-1]=arguments[l];return t.info(r,...a,{function:e})},warn:function(r){for(var n=arguments.length,a=Array(n>1?n-1:0),l=1;l<n;l++)a[l-1]=arguments[l];return t.warn(r,...a,{function:e})},error:(t,r)=>this.error(t,r,{function:e})}}constructor(e=1){this.context={},this.level=e}}let a=new n,l={NETWORK_ERROR:"NETWORK_ERROR",TIMEOUT_ERROR:"TIMEOUT_ERROR",RATE_LIMIT_ERROR:"RATE_LIMIT_ERROR",RSS_PARSE_ERROR:"RSS_PARSE_ERROR",RSS_FETCH_ERROR:"RSS_FETCH_ERROR",RSS_INVALID_FORMAT:"RSS_INVALID_FORMAT",AUDIO_PLAYBACK_ERROR:"AUDIO_PLAYBACK_ERROR",AUDIO_LOAD_ERROR:"AUDIO_LOAD_ERROR",AUDIO_NOT_FOUND:"AUDIO_NOT_FOUND",ALBUM_NOT_FOUND:"ALBUM_NOT_FOUND",ALBUM_LOAD_ERROR:"ALBUM_LOAD_ERROR",IMAGE_LOAD_ERROR:"IMAGE_LOAD_ERROR",IMAGE_TIMEOUT_ERROR:"IMAGE_TIMEOUT_ERROR",IMAGE_CORS_ERROR:"IMAGE_CORS_ERROR",VALIDATION_ERROR:"VALIDATION_ERROR",PERMISSION_ERROR:"PERMISSION_ERROR",UNKNOWN_ERROR:"UNKNOWN_ERROR"};class o extends Error{constructor(e,t="UNKNOWN_ERROR",r=500,n=!0,a,l){super(e),this.message=e,this.code=t,this.statusCode=r,this.isOperational=n,this.details=a,this.context=l,this.name="AppError",Error.captureStackTrace(this,this.constructor)}}let i={NETWORK_ERROR:"Network connection failed. Please check your internet connection.",TIMEOUT_ERROR:"Request timed out. Please try again.",RATE_LIMIT_ERROR:"Too many requests. Please wait a moment and try again.",IMAGE_CORS_ERROR:"Image loading blocked by browser security.",UNKNOWN_ERROR:"An unexpected error occurred. Please try again."};function s(e){return e instanceof o?e.message:e instanceof Error?e.message.includes("fetch")?i.NETWORK_ERROR:e.message.includes("timeout")?i.TIMEOUT_ERROR:e.message.includes("429")||e.message.includes("rate limit")?i.RATE_LIMIT_ERROR:e.message.includes("CORS")||e.message.includes("cross-origin")?i.IMAGE_CORS_ERROR:e.message:i.UNKNOWN_ERROR}function c(e){return{error:(t,r,n)=>{new Date().toISOString(),r instanceof Error&&(r.name,r.message,r.stack),a.error("[".concat(e,"] ").concat(t),r,{context:e})},warn:(t,r)=>{let n=new Date().toISOString();a.warn("[".concat(e,"] ").concat(t),{timestamp:n,details:r})},info:(t,r)=>{let n=new Date().toISOString();a.info("[".concat(e,"] ").concat(t),{timestamp:n,details:r})}}}async function u(e){let t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{maxRetries:n=3,delay:i=1e3,backoff:s=2,onRetry:c,context:u="withRetry"}=r;for(let r=1;r<=n;r++)try{return await e()}catch(g){if(t=g,r===n)throw a.error("[".concat(u,"] Final retry attempt failed"),g,{context:u,attempt:r,maxRetries:n}),g;if(!function(e){return e instanceof o?[l.NETWORK_ERROR,l.TIMEOUT_ERROR,l.RATE_LIMIT_ERROR,l.RSS_FETCH_ERROR,l.AUDIO_LOAD_ERROR,l.IMAGE_LOAD_ERROR,l.IMAGE_TIMEOUT_ERROR].includes(e.code):e instanceof Error&&["network","timeout","fetch","429","rate limit","temporary","retry"].some(t=>e.message.toLowerCase().includes(t))}(g))throw a.warn("[".concat(u,"] Non-retryable error, not retrying"),{context:u,attempt:r,error:g instanceof Error?g.message:g}),g;let e=i*Math.pow(s,r-1);a.warn("[".concat(u,"] Attempt ").concat(r," failed, retrying in ").concat(e,"ms"),{context:u,attempt:r,maxRetries:n,waitTime:e,error:g instanceof Error?g.message:g}),c&&c(r,g),await new Promise(t=>setTimeout(t,e))}throw t}},4966:(e,t,r)=>{r.d(t,{K:()=>i});var n=r(1404);let a="verbose"===r(7358).env.NEXT_PUBLIC_LOG_LEVEL,l=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r]},o=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];a&&console.log(...t)};class i{static async parseAlbumFeed(e){return(0,n.bD)(async()=>{var t,r,a,i,s,c,u,g,m,d,f,R,h,E,p,y,O,N,A,S,T,v,_,w,I,b,D,C,M;let B,x,F;o("[RSSParser] Parsing RSS feed",{feedUrl:e});try{{let t,r=e.startsWith("/api/"),n=e.startsWith("/api/fetch-rss");t=r&&!n||n?e:"/api/fetch-rss?url=".concat(encodeURIComponent(e)),B=await fetch(t)}}catch(t){throw new n.uV("Failed to fetch RSS feed",n.tG.RSS_FETCH_ERROR,500,!0,{feedUrl:e,error:t})}if(!B.ok){if(429===B.status)throw new n.uV("Rate limited while fetching RSS feed",n.tG.RATE_LIMIT_ERROR,429,!0,{feedUrl:e,status:B.status});throw new n.uV("Failed to fetch RSS feed: ".concat(B.status),n.tG.RSS_FETCH_ERROR,B.status,B.status>=500,{feedUrl:e,status:B.status})}let U=await B.text();if(!U||0===U.trim().length)throw new n.uV("Empty response from RSS feed",n.tG.RSS_INVALID_FORMAT,400,!1,{feedUrl:e});if(!U.includes("<")||!U.includes(">"))throw this.logger.error("Invalid XML response",null,{feedUrl:e,responsePreview:U.substring(0,200)}),new n.uV("Response is not valid XML",n.tG.RSS_INVALID_FORMAT,400,!1,{feedUrl:e});try{let t=(x=new DOMParser().parseFromString(U,"text/xml")).getElementsByTagName("parsererror")[0];if(t)throw new n.uV("Invalid XML format in RSS feed",n.tG.RSS_PARSE_ERROR,400,!1,{feedUrl:e,parserError:t.textContent})}catch(t){if(t instanceof n.uV)throw t;throw new n.uV("Failed to parse XML content",n.tG.RSS_PARSE_ERROR,400,!1,{feedUrl:e,error:t})}let L=x.getElementsByTagName("channel");if(!L||0===L.length)throw new n.uV("Invalid RSS feed: no channel found",n.tG.RSS_INVALID_FORMAT,400,!1,{feedUrl:e});let k=L[0],P=k.getElementsByTagName("title")[0],G=(null==P||null==(t=P.textContent)?void 0:t.trim())||"Unknown Album",W=k.getElementsByTagName("description")[0],V=(null==W||null==(r=W.textContent)?void 0:r.trim())||"",K=k.getElementsByTagName("link")[0],H=(null==K||null==(a=K.textContent)?void 0:a.trim())||"",q=e=>{if(e)return e.replace(/<[^>]*>/g,"").replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#39;/g,"'").trim()},X="Unknown Artist",j=k.getElementsByTagName("itunes:author"),Y=j.length>0?j[0]:k.getElementsByTagName("author")[0];if(Y)X=(null==(O=Y.textContent)?void 0:O.trim())||X;else{let e=G.split(" - ");e.length>1&&(X=e[0].trim())}let $=x.getElementsByTagName("item"),z=null,J=k.getElementsByTagName("itunes:image")[0]||null;if(J||(J=k.querySelector("itunes\\:image")),J&&(z=J.getAttribute("href")||null),!z){let e=k.querySelector("image url");e&&(z=(null==(N=e.textContent)?void 0:N.trim())||null)}if(!z&&$.length>0){let e=$[0].getElementsByTagName("itunes:image")[0];e&&(z=e.getAttribute("href")||null)}if(z)try{let e=new URL(z);(e.href.includes("javascript:")||e.href.includes("data:"))&&(console.warn("Potentially unsafe cover art URL detected:",z),z=null)}catch(e){z&&!z.startsWith("http")&&(o("Invalid cover art URL format:",z),z=null)}let Q=null==(s=k.getElementsByTagName("itunes:subtitle")[0])||null==(i=s.textContent)?void 0:i.trim(),Z=null==(u=k.getElementsByTagName("itunes:summary")[0])||null==(c=u.textContent)?void 0:c.trim(),ee=k.getElementsByTagName("language")[0],et=null==ee||null==(g=ee.textContent)?void 0:g.trim(),er=k.getElementsByTagName("copyright")[0],en=null==er||null==(m=er.textContent)?void 0:m.trim(),ea=k.getElementsByTagName("itunes:explicit")[0],el=(null==ea||null==(d=ea.textContent)?void 0:d.trim().toLowerCase())==="true",eo=k.getElementsByTagName("itunes:keywords")[0],ei=(null==eo||null==(f=eo.textContent)?void 0:f.trim().split(",").map(e=>e.trim()).filter(e=>e))||[],es=Array.from(k.getElementsByTagName("itunes:category")).map(e=>e.getAttribute("text")).filter(Boolean),ec=k.getElementsByTagName("itunes:owner")[0],eu=ec?{name:null==(h=ec.getElementsByTagName("itunes:name")[0])||null==(R=h.textContent)?void 0:R.trim(),email:null==(p=ec.getElementsByTagName("itunes:email")[0])||null==(E=p.textContent)?void 0:E.trim()}:void 0,eg=[];($.length>10||0===$.length)&&l("\uD83C\uDFB5 Found ".concat($.length," items in RSS feed"));for(let e=0;e<$.length;e++){let t,r=$[e],n=(null==(S=r.getElementsByTagName("title")[0])||null==(A=S.textContent)?void 0:A.trim())||"Track ".concat(e+1),a="0:00",l=r.getElementsByTagName("itunes:duration")[0],i=r.getElementsByTagName("duration")[0];if((null==l||null==(T=l.textContent)?void 0:T.trim())?a=l.textContent.trim():(null==i||null==(v=i.textContent)?void 0:v.trim())&&(a=i.textContent.trim()),a&&""!==a.trim()){let e=a.trim();if(/^\d+$/.test(e)){let t=parseInt(e);if(!isNaN(t)&&t>0){let e=Math.floor(t/60),r=t%60;a="".concat(e,":").concat(r.toString().padStart(2,"0"))}else a="0:00",o('⚠️ Invalid duration seconds "'.concat(e,'" for track "').concat(n,'", using default'))}else if(e.includes(":")){let t=e.split(":");if(2===t.length){let r=parseInt(t[0]),l=parseInt(t[1]);!isNaN(r)&&!isNaN(l)&&r>=0&&l>=0&&l<60?a="".concat(r,":").concat(l.toString().padStart(2,"0")):(a="0:00",o('⚠️ Invalid MM:SS duration "'.concat(e,'" for track "').concat(n,'", using default')))}else if(3===t.length){let r=parseInt(t[0]),l=parseInt(t[1]),i=parseInt(t[2]);if(!isNaN(r)&&!isNaN(l)&&!isNaN(i)&&r>=0&&l>=0&&l<60&&i>=0&&i<60){let e=60*r+l,t=a;a="".concat(e,":").concat(i.toString().padStart(2,"0")),r>0&&o('\uD83D\uDD04 Converted HH:MM:SS "'.concat(t,'" to MM:SS "').concat(a,'" for "').concat(n,'"'))}else a="0:00",o('⚠️ Invalid HH:MM:SS duration "'.concat(e,'" for track "').concat(n,'", using default'))}else a="0:00",o('⚠️ Unknown duration format "'.concat(e,'" for track "').concat(n,'", using default'))}else a="0:00",o('⚠️ Cannot parse duration "'.concat(e,'" for track "').concat(n,'", using default'))}else a="0:00",o('⚠️ No duration found for track "'.concat(n,'", using default'));a.includes("NaN")&&(a="0:00",o('⚠️ Duration contained NaN for track "'.concat(n,'", using default')));let s=r.getElementsByTagName("enclosure")[0];if(s&&(t=s.getAttribute("url")||void 0),!t){let e=r.getElementsByTagName("link")[0];e&&(t=(null==(M=e.textContent)?void 0:M.trim())||void 0)}if(!t){let e=r.getElementsByTagName("media:content")[0];e&&(t=e.getAttribute("url")||void 0)}let c=null==(w=r.getElementsByTagName("itunes:subtitle")[0])||null==(_=w.textContent)?void 0:_.trim(),u=null==(b=r.getElementsByTagName("itunes:summary")[0])||null==(I=b.textContent)?void 0:I.trim(),g=e=>{if(e)return e.replace(/<[^>]*>/g,"").replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#39;/g,"'").trim()},m=r.getElementsByTagName("itunes:image")[0],d=(null==m?void 0:m.getAttribute("href"))||(null==m?void 0:m.getAttribute("url")),f=r.getElementsByTagName("itunes:explicit")[0],R=(null==f||null==(D=f.textContent)?void 0:D.trim().toLowerCase())==="true",h=r.getElementsByTagName("itunes:keywords")[0],E=(null==h||null==(C=h.textContent)?void 0:C.trim().split(",").map(e=>e.trim()).filter(e=>e))||[];eg.push({title:n,duration:a,url:t,trackNumber:e+1,subtitle:g(c),summary:g(u),image:d||void 0,explicit:R,keywords:E.length>0?E:void 0}),t||o('⚠️ Track missing URL: "'.concat(n,'" (').concat(a,")"))}let em=k.getElementsByTagName("pubDate")[0]||k.getElementsByTagName("lastBuildDate")[0],ed=(null==em||null==(y=em.textContent)?void 0:y.trim())||new Date().toISOString(),ef=[];[...Array.from(k.getElementsByTagName("podcast:funding")),...Array.from(k.getElementsByTagName("funding"))].forEach(e=>{var t,r;let n=e.getAttribute("url")||(null==(t=e.textContent)?void 0:t.trim()),a=(null==(r=e.textContent)?void 0:r.trim())||e.getAttribute("message");n&&ef.push({url:n,message:a||void 0})});let eR=[];[...Array.from(k.getElementsByTagName("podcast:podroll")),...Array.from(k.getElementsByTagName("podroll"))].forEach(e=>{var t;[...Array.from(e.getElementsByTagName("podcast:remoteItem")),...Array.from(e.getElementsByTagName("remoteItem"))].forEach(e=>{var t;let r=e.getAttribute("feedUrl"),n=e.getAttribute("feedGuid"),a=e.getAttribute("title")||(null==(t=e.textContent)?void 0:t.trim()),l=e.getAttribute("description");r&&eR.push({url:r,title:a||"Feed ".concat(n?n.substring(0,8)+"...":"Unknown"),description:l||void 0})});let r=e.getAttribute("url"),n=e.getAttribute("title")||(null==(t=e.textContent)?void 0:t.trim()),a=e.getAttribute("description");r&&eR.push({url:r,title:n||void 0,description:a||void 0})});let eh=Array.from(k.getElementsByTagName("podcast:remoteItem")).find(e=>"publisher"===e.getAttribute("medium"));if(eh){let e=eh.getAttribute("feedGuid"),t=eh.getAttribute("feedUrl"),r=eh.getAttribute("medium");e&&t&&r&&(F={feedGuid:e,feedUrl:t,medium:r})}let eE={title:G,artist:X,description:q(V)||"",coverArt:z,tracks:eg,releaseDate:ed,link:H,funding:ef.length>0?ef:void 0,subtitle:q(Q),summary:q(Z),keywords:ei.length>0?ei:void 0,categories:es.length>0?es:void 0,explicit:el,language:et,copyright:en,owner:eu&&(eu.name||eu.email)?eu:void 0,podroll:eR.length>0?eR:void 0,publisher:F};return o("[RSSParser] Successfully parsed RSS feed",{feedUrl:e,trackCount:eg.length}),eE},{maxRetries:3,delay:1e3,onRetry:(t,r)=>{this.logger.warn("Retrying RSS feed parse (attempt ".concat(t,")"),{feedUrl:e,error:r})}}).catch(t=>(this.logger.error("Failed to parse RSS feed after retries",t,{feedUrl:e}),null))}static async parseMultipleFeeds(e){e.length>5&&l("\uD83D\uDD04 Parsing ".concat(e.length," RSS feeds..."));let t=[];for(let r=0;r<e.length;r+=20){let a=e.slice(r,r+20);e.length>10&&l("\uD83D\uDCE6 Processing batch ".concat(Math.floor(r/20)+1,"/").concat(Math.ceil(e.length/20)," (").concat(a.length," feeds)"));let o=a.map(async e=>{try{return await (0,n.bD)(()=>this.parseAlbumFeed(e),{maxRetries:2,delay:1e3,onRetry:(t,r)=>{this.logger.warn("Retrying feed parse (attempt ".concat(t,")"),{url:e,error:r})}})}catch(t){if(t instanceof TypeError&&t.message.includes("NetworkError"))return console.error("❌ NetworkError when attempting to fetch resource."),console.log("\uD83D\uDD0D Error details:",{message:t.message,stack:t.stack,feedUrl:e}),null;return console.error("❌ Failed to parse feed ".concat(e," after retries:"),t),null}}),i=await Promise.allSettled(o),s=i.filter(e=>"fulfilled"===e.status&&null!==e.value),c=i.filter(e=>"rejected"===e.status||null===e.value);c.length>0&&e.length>10&&(console.warn("⚠️ Failed to parse ".concat(c.length," feeds in batch ").concat(Math.floor(r/20)+1)),c.slice(0,2).forEach((e,t)=>{"rejected"===e.status?console.error("❌ Failed to parse feed ".concat(a[t],": ").concat(e.reason)):"fulfilled"===e.status&&null===e.value&&console.error("❌ Feed ".concat(a[t]," returned null"))}),c.length>2&&console.warn("... and ".concat(c.length-2," more failures"))),t.push(...s.map(e=>e.value)),r+20<e.length&&await new Promise(e=>setTimeout(e,50))}return e.length>5&&l("✅ Successfully parsed ".concat(t.length," albums from ").concat(e.length," feeds")),t}static async parsePublisherFeedInfo(e){try{var t,r,n,a;let l,o;{let t,r=e.startsWith("/api/"),n=e.startsWith("/api/fetch-rss");t=r&&!n||n?e:"/api/fetch-rss?url=".concat(encodeURIComponent(e)),l=await fetch(t)}if(!l.ok)throw Error("Failed to fetch publisher feed: ".concat(l.status));let i=await l.text();if((o=new DOMParser().parseFromString(i,"text/xml")).getElementsByTagName("parsererror")[0])throw Error("Invalid XML format");let s=o.getElementsByTagName("channel");if(!s||0===s.length)throw Error("Invalid RSS feed: no channel found");let c=s[0],u=c.getElementsByTagName("title")[0],g=(null==u||null==(t=u.textContent)?void 0:t.trim())||"",m=c.getElementsByTagName("description")[0],d=(null==m||null==(r=m.textContent)?void 0:r.trim())||"",f=g,R=c.getElementsByTagName("itunes:author"),h=R.length>0?R[0]:c.getElementsByTagName("author")[0];h&&(f=(null==(n=h.textContent)?void 0:n.trim())||f);let E=null,p=c.getElementsByTagName("itunes:image")[0]||null;if(p||(p=c.querySelector("itunes\\:image")),p&&(E=p.getAttribute("href")||null),!E){let e=c.querySelector("image url");e&&(E=(null==(a=e.textContent)?void 0:a.trim())||null)}return{title:g,description:d,artist:f,coverArt:E||void 0}}catch(e){return console.error("❌ Error parsing publisher feed info:",e),null}}static async parsePublisherFeed(e){try{let t,r;if("iroh-aggregated"===e){let e,t;console.log("\uD83C\uDFB5 Loading IROH aggregated feed from Wavlake...");{let t="/api/fetch-rss?url=".concat(encodeURIComponent("https://wavlake.com/feed/artist/8a9c2e54-785a-4128-9412-737610f5d00a"));e=await fetch(t)}if(!e.ok)throw Error("Failed to fetch IROH artist feed: ".concat(e.status));let r=await e.text();if((t=new DOMParser().parseFromString(r,"text/xml")).getElementsByTagName("parsererror")[0])throw Error("Invalid XML format");let n=t.getElementsByTagName("channel");if(!n||0===n.length)throw Error("Invalid RSS feed: no channel found");let a=n[0],o=[];return Array.from(a.getElementsByTagName("podcast:remoteItem")).forEach(e=>{var t;let r=e.getAttribute("medium"),n=e.getAttribute("feedGuid"),a=e.getAttribute("feedUrl"),l=e.getAttribute("title")||(null==(t=e.textContent)?void 0:t.trim());"music"===r&&n&&a&&o.push({feedGuid:n,feedUrl:a,medium:r,title:l})}),l("\uD83C\uDFE2 Found ".concat(o.length," music items in IROH aggregated feed")),o}if("string"!=typeof e)throw console.error("parsePublisherFeed: feedUrl is not a string:",e),TypeError("feedUrl must be a string (URL). Received: "+typeof e);{let r,n=e.startsWith("/api/"),a=e.startsWith("/api/fetch-rss");r=n&&!a||a?e:"/api/fetch-rss?url=".concat(encodeURIComponent(e)),t=await fetch(r)}if(!t.ok)throw Error("Failed to fetch publisher feed: ".concat(t.status));let n=await t.text();if((r=new DOMParser().parseFromString(n,"text/xml")).getElementsByTagName("parsererror")[0])throw Error("Invalid XML format");let a=r.getElementsByTagName("channel");if(!a||0===a.length)throw Error("Invalid RSS feed: no channel found");let o=a[0],i=[];return Array.from(o.getElementsByTagName("podcast:remoteItem")).forEach(e=>{var t;let r=e.getAttribute("medium"),n=e.getAttribute("feedGuid"),a=e.getAttribute("feedUrl"),l=e.getAttribute("title")||(null==(t=e.textContent)?void 0:t.trim());"music"===r&&n&&a&&i.push({feedGuid:n,feedUrl:a,medium:r,title:l})}),l("\uD83C\uDFE2 Found ".concat(i.length," music items in publisher feed: ").concat(e)),i}catch(e){return console.error("❌ Error parsing publisher feed:",e),[]}}static async parsePublisherFeedAlbums(e){l("\uD83C\uDFE2 Parsing publisher feed for albums: ".concat(e));let t=await this.parsePublisherFeed(e);if(0===t.length)return l("\uD83D\uDCED No music items found in publisher feed: ".concat(e)),[];let r=t.map(e=>e.feedUrl);l("\uD83C\uDFB5 Loading ".concat(r.length," music feeds from publisher..."));let n=5,a=500;r.length>20&&(n=8,a=300);let o=[];for(let e=0;e<r.length;e+=n){let t=r.slice(e,e+n),i=Math.floor(e/n)+1,s=Math.ceil(r.length/n);l("\uD83D\uDCE6 Processing publisher batch ".concat(i,"/").concat(s," (").concat(t.length," feeds)"));try{let e=await this.parseMultipleFeeds(t);o.push(...e),l("✅ Batch ".concat(i,"/").concat(s," completed: ").concat(e.length," albums (").concat(o.length,"/").concat(r.length," total)"))}catch(e){console.error("❌ Error in publisher batch ".concat(i,"/").concat(s,":"),e)}e+n<r.length&&await new Promise(e=>setTimeout(e,a))}return l("\uD83C\uDFB6 Loaded ".concat(o.length," albums from publisher feed")),o}}i.logger=(0,n.vf)("RSSParser")}}]);